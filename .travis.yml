language: node_js
#  latest stable Node.js release
node_js: lts/*
addons:
  chrome: stable # make Chrome available
# Cache node packages between jobs
cache: npm

script:
  - npm run lint
  # - npm run test
  - travis_wait npm run generate
  - npm run bundlewatch
  - npm run lhci:autorun
  - npm run start:test
  - npm run test:e2e
  - npx semantic-release

deploy:
  - provider: surge
    domain: brisbane-city-council-free-native-plants.daim.dev
    project: ./dist
    # edge: true # opt in to dpl v2
    skip_cleanup: true
    on:
      branch: master

  - provider: surge
    domain: staging.brisbane-city-council-free-native-plants.daim.dev
    project: ./dist
    # edge: true # opt in to dpl v2
    skip_cleanup: true
    on:
      all_branches: true
